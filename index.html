<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Bee or Not To Bee</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fefce8; /* cream */ }
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 1rem; text-align: center; }
        .active-screen { display: flex; }
        .button {
            background-color: #facc15; /* yellow-500 */
            color: #422006; /* amber-950 */
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            margin: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s;
            border: 2px solid #ca8a04; /* yellow-600 */
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .button:hover {
            background-color: #eab308; /* yellow-600 */
        }
        .button:disabled {
            background-color: #a1a1aa; /* zinc-400 */
            cursor: not-allowed;
            border-color: #71717a; /* zinc-500 */
        }
        .info-box {
            background-color: #fffbeb; /* yellow-50 */
            border: 1px solid #fde68a; /* yellow-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 0.5rem 0;
            min-width: 300px;
            max-width: 500px;
            white-space: pre-line; /* To respect \n in text */
        }
        .game-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            width: 100%;
            max-width: 900px;
        }
        @media (min-width: 768px) {
            .game-layout {
                grid-template-columns: 1fr 2fr 1fr;
            }
        }
        .main-image {
            width: 100%;
            max-width: 400px; /* Max width for the main game image */
            height: 300px; /* Fixed height for consistency */
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            object-fit: cover; /* Ensures the image covers the area, cropping if necessary */
            background-color: #e5e7eb; /* A light gray background for the image area */
        }
         .start-screen-logo {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 0.5rem; /* Or rounded-full if you prefer */
            margin-bottom: 1.5rem; /* Corresponds to mb-6 */
            background-color: #e5e7eb;
         }
         .end-screen-image {
            width: 100%;
            max-width: 200px;
            height: 200px; /* Fixed height */
            border-radius: 0.5rem;
            margin: 1rem auto; /* Centering and margin */
            object-fit: cover;
            background-color: #e5e7eb;
        }
    </style>
</head>
<body>

    <div id="start-screen" class="screen active-screen bg-yellow-100">
        <div class="bg-white p-8 rounded-lg shadow-xl max-w-md w-full">
            <img id="start-screen-logo-img" src="https://mikayla0web.github.io/images/startScreen.png" 
                 alt="Bee Game Logo" 
                 class="mx-auto start-screen-logo"
                 onerror="this.onerror=null; this.src='https://placehold.co/150x150/cccccc/969696?text=Image+Not+Found';">
            <h1 id="start-title" class="text-4xl font-bold text-yellow-700 mb-4">Welcome to: <br>To Bee Or Not To Bee!</h1>
            <p id="start-instructions" class="text-lg text-yellow-800 mb-8">Can you learn to survive in the hive? <br>Choose which role you would like to bee below!</p>
            <div class="flex flex-col sm:flex-row justify-center">
                <button id="drone-bee-button" class="button">Drone Bee</button>
                <button id="worker-bee-button" class="button">Worker Bee</button>
                <button id="queen-bee-button" class="button">Queen Bee</button>
            </div>
        </div>
    </div>

    <div id="game-screen" class="screen bg-green-100">
        <div class="game-layout items-start">
            <div class="info-box bg-lime-50 border-lime-200 order-2 md:order-1">
                <h2 class="text-xl font-semibold text-lime-700 mb-2">Your Bee</h2>
                <p id="bee-info-left" class="text-lime-800"></p>
            </div>

            <div class="flex flex-col items-center order-1 md:order-2">
                <img id="main-screen-image" src="https://mikayla0web.github.io/images/worker.jpg" alt="Game Scene" 
                     class="main-image shadow-lg"
                     onerror="this.onerror=null; this.src='https://placehold.co/400x300/cccccc/969696?text=Image+Not+Found';">
                <div class="info-box bg-lime-50 border-lime-200 w-full">
                    <h2 class="text-xl font-semibold text-lime-700 mb-2">Current Event</h2>
                    <p id="event-text-field" class="text-lime-800 min-h-[6em]"></p>
                </div>
                <div class="info-box bg-orange-50 border-orange-200 w-full mt-4">
                     <h2 class="text-xl font-semibold text-orange-700 mb-2">Result</h2>
                    <p id="result-text-field" class="text-orange-800 min-h-[3em]"></p>
                </div>
                <div class="mt-6">
                    <button id="yes-button" class="button bg-green-500 hover:bg-green-600 border-green-600 text-white">YES</button>
                    <button id="no-button" class="button bg-red-500 hover:bg-red-600 border-red-600 text-white">NO</button>
                </div>
            </div>

            <div class="info-box bg-lime-50 border-lime-200 order-3 md:order-3">
                <h2 class="text-xl font-semibold text-lime-700 mb-2">Bee Stats</h2>
                <p id="bee-info-right" class="text-lime-800"></p>
            </div>
        </div>
    </div>

    <div id="end-screen" class="screen bg-blue-100">
        <div class="bg-white p-8 rounded-lg shadow-xl max-w-lg w-full relative">
            <img id="end-screen-bee-image" src="https://mikayla0web.github.io/images/workerEnd.jpeg" alt="Bee Outcome" 
                 class="mx-auto end-screen-image"
                 onerror="this.onerror=null; this.src='https://placehold.co/200x200/cccccc/969696?text=Image+Not+Found';">
            <h1 id="end-title-text-field" class="text-3xl font-bold text-blue-700 mb-4">Game Over</h1>
            <div class="info-box bg-blue-50 border-blue-200">
                <p id="end-summary-text-area" class="text-blue-800 text-lg"></p>
            </div>
            <button id="restart-button" class="button mt-8 bg-blue-500 hover:bg-blue-600 border-blue-600 text-white">Restart Game</button>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');

        // Start Screen Elements
        const startScreenLogoImg = document.getElementById('start-screen-logo-img');
        const droneBeeButton = document.getElementById('drone-bee-button');
        const workerBeeButton = document.getElementById('worker-bee-button');
        const queenBeeButton = document.getElementById('queen-bee-button');

        // Game Screen Elements
        const mainScreenImage = document.getElementById('main-screen-image');
        const beeInfoLeft = document.getElementById('bee-info-left');
        const beeInfoRight = document.getElementById('bee-info-right');
        const eventTextField = document.getElementById('event-text-field');
        const resultTextField = document.getElementById('result-text-field');
        const yesButton = document.getElementById('yes-button');
        const noButton = document.getElementById('no-button');

        // End Screen Elements
        const endScreenBeeImage = document.getElementById('end-screen-bee-image');
        const endTitleTextField = document.getElementById('end-title-text-field');
        const endSummaryTextArea = document.getElementById('end-summary-text-area');
        const restartButton = document.getElementById('restart-button');

        // --- Game State Variables ---
        let currentBee = null;
        let currentEventText = '';
        let eventHandled = true; 

        // --- Image Base URL ---
        const IMAGE_BASE_URL = "https://mikayla0web.github.io/images/"; // Assuming your repo is mikayla0web.github.io

        // --- Constants (from Java Constants.java) ---
        const BEE_CONSTANTS = {
            DRONE: { NAME: "Drone Bee", SIZE: 2, GENDER: "Male", LIFESPAN: 30, COLOR: "Yellow", TASKS: "\n-Mate with queen \n-Die", ROLE: "drone" },
            WORKER: { NAME: "Worker Bee", SIZE: 1, GENDER: "Female", LIFESPAN: 60, COLOR: "Yellow", TASKS: "\n-Take care of queen \n-Collect nectar \n-Collect Pollen \n-Nurse larvae \n-Feed drones \n-Protect hive", ROLE: "worker" },
            QUEEN: { NAME: "Queen Bee", SIZE: 3, GENDER: "Female", LIFESPAN: 1825, COLOR: "Orangish-yellow", TASKS: "\n-Lay eggs \n-Watch over hive \n-Eat", ROLE: "queen" }
        };

        // --- Bee Classes (from Java Bee.java and subclasses) ---
        class Bee {
            constructor(name, size, gender, role, color, tasks) {
                this.name = name; 
                this.sizeInCm = size;
                this.gender = gender;
                this.role = role; 
                this.eventCount = 0;
                this.lastEventResult = "";
                this.color = color;
                this.tasks = tasks;
            }
            incrementEventCount() { this.eventCount++; }
            getEventCount() { return this.eventCount; }
            hasReachedLifespan() { return this.eventCount >= 7; } 
            getType() { return this.role; } 
            toString() { return `Bee Role: ${this.name}\nSize: ${this.sizeInCm} cm\nGender: ${this.gender}`; }
            stats() { return `Events Survived: ${this.getEventCount()} / 7\nPrimary color: ${this.color}\nUsual Tasks: ${this.tasks}`; }
            setLastEventResult(result) {
                this.lastEventResult = result;
                this.incrementEventCount();
            }
            getLifeSpan() { throw new Error("getLifeSpan must be implemented by subclasses"); }
        }

        class DroneBee extends Bee {
            constructor() { super(BEE_CONSTANTS.DRONE.NAME, BEE_CONSTANTS.DRONE.SIZE, BEE_CONSTANTS.DRONE.GENDER, BEE_CONSTANTS.DRONE.ROLE, BEE_CONSTANTS.DRONE.COLOR, BEE_CONSTANTS.DRONE.TASKS); }
            getLifeSpan() { return BEE_CONSTANTS.DRONE.LIFESPAN; }
        }

        class WorkerBee extends Bee {
            constructor() { super(BEE_CONSTANTS.WORKER.NAME, BEE_CONSTANTS.WORKER.SIZE, BEE_CONSTANTS.WORKER.GENDER, BEE_CONSTANTS.WORKER.ROLE, BEE_CONSTANTS.WORKER.COLOR, BEE_CONSTANTS.WORKER.TASKS); }
            getLifeSpan() { return BEE_CONSTANTS.WORKER.LIFESPAN; }
        }

        class QueenBee extends Bee {
            constructor() { super(BEE_CONSTANTS.QUEEN.NAME, BEE_CONSTANTS.QUEEN.SIZE, BEE_CONSTANTS.QUEEN.GENDER, BEE_CONSTANTS.QUEEN.ROLE, BEE_CONSTANTS.QUEEN.COLOR, BEE_CONSTANTS.QUEEN.TASKS); }
            getLifeSpan() { return BEE_CONSTANTS.QUEEN.LIFESPAN; }
        }

        // --- Actions and Events Logic (from Java ActionsAndEvents.java) ---
        const actionsAndEventsLogic = {
            eventCollections: { /* Same as before */
                worker: [
                    "There is a pretty flower in the window, would you like to get a closer look?",
                    "The nectar looks very tempting, would you like to sneak a little taste?",
                    "The queen has requested all worker bees to the royal room, would you like to attend?",
                    "A bear paw is attacking the hive! Would you like to attack?",
                    "The sky is looking a bit cloudy... do you still want to go to work?",
                    "The larvae are looking a little hungry, would you like to feed them royal jelly?",
                    "Winter is approaching and food is scarce, would you like to kick the drones out of the hive?"
                ],
                drone: [
                    "The nectar looks very tempting, would you like to sneak a little taste?",
                    "The queen has been working very hard today, would you like to offer the queen a snack?",
                    "The queen is only mating with five drones today, would you like to volunteer?",
                    "The queen declared no work today, would you like to explore the outdoors?",
                    "The queen seems to be checking you out from across the room, would you like to wink at her?",
                    "The worker bees seems to be surrounding the drone room, would you like to sneak out for a minute?",
                    "The worker bees left pollen all over the floor! Would you like to sweep it up?"
                ],
                queen: [
                    "Laying eggs is a lot of work, would you like to ask your servant for a drink?",
                    "The nectar looks very tempting, would you like to sneak a little taste?",
                    "The weather is beautiful today! Would you like to announce a day off to the bees?",
                    "A drone bee asked for extra food rations this week, would you like to punish him?",
                    "A bear is attacking the hive! Do you want to assemble the worker bees to attack?",
                    "Winter is approaching and food is scarce, would you like to kick the drones out of the hive?",
                    "The bees are getting worried for the queen, would you like to make a public appearance to reassure your subjects?"
                ]
            },
            availableEvents: {},
            currentEventInternal: '', 

            _shuffleArray(array) { /* Same as before */
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            },

            initAvailableEvents() { /* Same as before */
                this.availableEvents = {}; 
                for (const beeType in this.eventCollections) {
                    this.availableEvents[beeType] = [...this.eventCollections[beeType]];
                    this._shuffleArray(this.availableEvents[beeType]);
                }
            },

            generateEvent(beeType) { /* Same as before */
                const type = beeType.toLowerCase();
                if (!this.availableEvents[type] || this.availableEvents[type].length === 0) {
                    this.availableEvents[type] = [...this.eventCollections[type]];
                    this._shuffleArray(this.availableEvents[type]);
                    if (this.availableEvents[type].length === 0) return "The hive is quiet. No new events for now.";
                }
                this.currentEventInternal = this.availableEvents[type].shift();
                return this.currentEventInternal;
            },

            handleEvent(beeType, userChoice, eventText) { /* Same as before */
                const type = beeType.toLowerCase();
                switch (type) {
                    case "worker":
                        switch (eventText) {
                            case "There is a pretty flower in the window, would you like to get a closer look?":
                                return userChoice ? "Game over. The flower was plastic and you were attacked by a fly swatter." : "Another bee approached and was swiftly smooshed with a fly swatter.";
                            case "The nectar looks very tempting, would you like to sneak a little taste?":
                                return userChoice ? "Totally worth the risk." : "Maybe one day.";
                            case "The queen has requested all worker bees to the royal room, would you like to attend?":
                                return "She gave everybody in attendance an extra ration of food!"; 
                            case "A bear paw is attacking the hive! Would you like to attack?":
                                return userChoice ? "Game over. You stung the bear and saved the hive! Unfortunately, your stinger has been ripped from your body." : "The bear was defeated but we lost a lot of friends during the fight.";
                            case "The sky is looking a bit cloudy... do you still want to go to work?":
                                return userChoice ? "Game over. A raindrop shot you down!" : "Good choice! The rain took down some bees today.";
                            case "The larvae are looking a little hungry, would you like to feed them royal jelly?":
                                return "I wonder what royal jelly tastes like."; 
                            case "Winter is approaching and food is scarce, would you like to kick the drones out of the hive?":
                                return "It was for the better."; 
                            default: return "Unknown Worker Event outcome.";
                        }
                    case "drone":
                        switch (eventText) {
                            case "The nectar looks very tempting, would you like to sneak a little taste?":
                                return userChoice ? "Game over. You were caught by the guards and publicly executed for treason!" : "Your self-control might have saved your life.";
                            case "The queen has been working very hard today, would you like to offer the queen a snack?":
                                return userChoice ? "Game over. The queen was displeased and had you buried alive in honey." : "Never bother the queen.";
                            case "The queen is only mating with five drones today, would you like to volunteer?":
                                return userChoice ? "The hive salutes you for your loyalty." : "Time to relax.";
                            case "The queen declared no work today, would you like to explore the outdoors?":
                                return userChoice ? "Game over. You only lasted 3 minutes in the wild before getting run over by a tricycle." : "You stayed inside the hive where it is safe.";
                            case "The queen seems to be checking you out from across the room, would you like to wink at her?":
                                return userChoice ? "Game over. The queen has you executed for humiliating her." : "Good thing you didn't respond, the queen was looking at the bee behind you.";
                            case "The worker bees seems to be surrounding the drone room, would you like to sneak out for a minute?":
                                return userChoice ? "Good timing! It seems the other drones were evicted due to limited food. You can stay hidden and feed on the jellies you've stashed." : "Game over. It seems the queen did her annual winter eviction. You will be missed.";
                            case "The worker bees left pollen all over the floor! Would you like to sweep it up?":
                                return userChoice ? "The worker bees returned and thanked you for collecting it for them." : "Game over. The hive executed you for not being a productive member of society.";
                            default: return "Unknown Drone Event outcome.";
                        }
                    case "queen":
                        switch (eventText) {
                            case "Laying eggs is a lot of work, would you like to ask your servant for a drink?":
                                return userChoice  ? "Game over. The servant poisoned you!" : "They probably poisoned it anyways.";
                            case "The nectar looks very tempting, would you like to sneak a little taste?":
                                return "Silly bee! You're queen, you never have to 'sneak a taste'."; 
                            case "The weather is beautiful today! Would you like to announce a day off to the bees?":
                                return userChoice ? "The bees are thankful for your kindness.": "This honey is not gonna make itself!";
                            case "A drone bee asked for extra food rations this week, would you like to punish him?":
                                return "Being a queen is all about the tough decisions."; 
                            case "A bear is attacking the hive! Do you want to assemble the worker bees to attack?":
                                return userChoice ? "We lost many workers along the way, but at least the hive is safe.": "Game over. Everyone perished.";
                            case "Winter is approaching and food is scarce, would you like to kick the drones out of the hive?":
                                return userChoice ? "They will be missed." : "Game over. The hive starved to death.";
                            case "The bees are getting worried for the queen, would you like to make a public appearance to reassure your subjects?":
                                return userChoice ? " Your subjects were pleased to see you.": "Game over! Your subjects revolted.";
                            default: return "Unknown Queen Event outcome.";
                        }
                    default: return "Unknown Bee Type for event handling.";
                }
            }
        };

        // --- Screen Management ---
        function showScreen(screenId) { /* Same as before */
            startScreen.classList.remove('active-screen');
            gameScreen.classList.remove('active-screen');
            endScreen.classList.remove('active-screen');
            document.getElementById(screenId).classList.add('active-screen');
        }

        // --- Image Update Logic ---
        function updateMainScreenImage(eventText, resultText) {
            let imageName = `${currentBee.role}.jpg`; // Default image for the bee type
            const eventLower = eventText.toLowerCase();
            const resultLower = resultText.toLowerCase();

            if (resultLower.includes("game over")) {
                // Assuming end images are JPEGs as per Java EndViewController
                imageName = `${currentBee.role}End.jpeg`; 
            } else if (resultText && !resultLower.includes("game over")) {
                 // Keep current bee image or a generic "pondering" image if you have one
                 imageName = `${currentBee.role}.jpg`; // Or e.g., `${currentBee.role}Ponders.jpg`
            } else { // New event is shown, pick image based on event
                if (eventLower.includes("flower")) imageName = "flowers.jpg";
                else if (eventLower.includes("nectar")) imageName = "sneakingHoney.png";
                else if (eventLower.includes("requested") || eventLower.includes("subjects")) imageName = "uneasySubjects.png";
                else if (eventLower.includes("bear")) imageName = "bear.jpg";
                else if (eventLower.includes("cloudy") || eventLower.includes("rain")) imageName = "stormy.jpg";
                else if (eventLower.includes("larvae") || eventLower.includes("snack")) imageName = "royalJelly.png";
                else if (eventLower.includes("winter") || eventLower.includes("scarce")) imageName = "snow.jpg";
                else if (eventLower.includes("declared") || eventLower.includes("beautiful")) imageName = "sunny.jpg";
                else if (eventLower.includes("rations")) imageName = "sadDrone.png";
                else if (eventLower.includes("drink")) imageName = "drink.jpg";
                // Default to bee's main image if no specific event image matches
                else imageName = `${currentBee.role}.jpg`;
            }
            mainScreenImage.src = IMAGE_BASE_URL + imageName;
            mainScreenImage.alt = eventText || currentBee.role; // Alt text
        }


        // --- Game Flow Functions ---
        function selectBeeType(beeConstructor) {
            currentBee = new beeConstructor();
            actionsAndEventsLogic.initAvailableEvents();
            displayGameScreenAndInitialEvent();
        }

        function displayGameScreenAndInitialEvent() {
            beeInfoLeft.textContent = currentBee.toString();
            beeInfoRight.textContent = currentBee.stats();
            
            eventTextField.textContent = `Welcome to the hive, ${currentBee.name}!\nLearn from your mistakes and adapt.\nClick YES to start working!`;
            resultTextField.textContent = "";
            
            // Set initial image for the selected bee type
            mainScreenImage.src = IMAGE_BASE_URL + `${currentBee.role}.jpg`;
            mainScreenImage.alt = currentBee.name;
            
            yesButton.disabled = false;
            noButton.disabled = true;
            eventHandled = true; 
            
            showScreen('game-screen');
        }

        function handlePlayerChoice(isYesChoice) {
            if (!currentBee) return;

            if (eventHandled) { 
                currentEventText = actionsAndEventsLogic.generateEvent(currentBee.role);
                eventTextField.textContent = currentEventText;
                resultTextField.textContent = "";
                updateMainScreenImage(currentEventText, "");
                eventHandled = false;
                noButton.disabled = false; 
            } else { 
                const result = actionsAndEventsLogic.handleEvent(currentBee.role, isYesChoice, currentEventText);
                resultTextField.textContent = result;
                currentBee.setLastEventResult(result);
                updateMainScreenImage(currentEventText, result);

                if (currentBee.hasReachedLifespan() || result.toLowerCase().includes("game over")) {
                    displayEndScreen();
                } else {
                    eventHandled = true;
                    noButton.disabled = true; 
                    eventTextField.textContent = "Press YES to continue to the next event.";
                }
            }
            beeInfoLeft.textContent = currentBee.toString(); 
            beeInfoRight.textContent = currentBee.stats();  
        }

        function displayEndScreen() {
            let title = `Your life as a ${currentBee.name.toLowerCase()} has ended.`;
            let summary = currentBee.lastEventResult;
            let beeImageFile = `${currentBee.role}End.jpeg`; // Default end image (assuming .jpeg)

            if (!summary.toLowerCase().includes("game over") && currentBee.hasReachedLifespan()) {
                title = `Congratulations ${currentBee.name.toLowerCase()}, you adapted and survived!`;
                summary = `This ${currentBee.name.toLowerCase()} has successfully completed its journey after ${currentBee.getEventCount()} events and left a buzzing legacy!`;
                beeImageFile = `${currentBee.role}Survived.png`; // Survived image (assuming .png)
            } else if (!summary) { 
                 summary = "The bee's journey has ended unexpectedly. Learn from your mistakes and try again!";
            }
            
            if (summary.toLowerCase().includes("game over") && !summary.toLowerCase().startsWith("game over")) {
                 summary = "Game over. " + summary; 
            }

            endTitleTextField.textContent = title;
            endSummaryTextArea.textContent = summary;
            endScreenBeeImage.src = IMAGE_BASE_URL + beeImageFile;
            endScreenBeeImage.alt = title;
            showScreen('end-screen');
        }

        function restartGame() { /* Same as before */
            currentBee = null;
            currentEventText = '';
            eventHandled = true;
            startScreenLogoImg.src = IMAGE_BASE_URL + "startScreen.png"; // Reset start screen image
            showScreen('start-screen');
        }

        // --- Event Listeners ---
        droneBeeButton.addEventListener('click', () => selectBeeType(DroneBee));
        workerBeeButton.addEventListener('click', () => selectBeeType(WorkerBee));
        queenBeeButton.addEventListener('click', () => selectBeeType(QueenBee));

        yesButton.addEventListener('click', () => handlePlayerChoice(true));
        noButton.addEventListener('click', () => handlePlayerChoice(false));

        restartButton.addEventListener('click', restartGame);

        // --- Initial Setup ---
        // Set the initial start screen logo image
        startScreenLogoImg.src = IMAGE_BASE_URL + "startScreen.png";
        showScreen('start-screen'); 

    </script>
</body>
</html>
